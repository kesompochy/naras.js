!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("NARAS",[],e):"object"==typeof exports?exports.NARAS=e():t.NARAS=e()}(self,(function(){return(()=>{"use strict";var t={178:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(108)),r=o(n(557)),u=n(285),a=function(){function t(){this.loader=new i.default,this.masterContainer=new u.MasterContainer,this._unlockEvents=["click","scroll","touchstart"];for(var t=0,e=this._unlockEvents.length;t<e;t++)document.addEventListener(this._unlockEvents[t],this._initContext.bind(this),{once:!0});this._initContext()}return t.prototype._initContext=function(){"suspended"===r.default.cxt.state&&r.default.cxt.resume();for(var t=0,e=this._unlockEvents.length;t<e;t++)document.removeEventListener(this._unlockEvents[t],this._initContext.bind(this))},t.prototype.addResource=function(t,e){return this.loader.add(t,e),this},t.prototype.loadAll=function(){this.loader.loadAll()},t.prototype.loadThen=function(t){this.loader.loadThen(t)},t}();e.default=a},557:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=window.AudioContext||window.webkitAudioContext,o=function(){function t(){}return t.cxt=new n,t}();e.default=o},285:function(t,e,n){var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.MasterContainer=e.defaultOptions=void 0;var u,a=r(n(557)),s=r(n(890)),c=r(n(666)),l=n(890);e.defaultOptions={volume:1,loop:!1,pitch:1,delay:l.defaultDelayParams,useDelay:!1},function(t){t.play="play",t.stop="stop",t.restart="restart",t.pause="pause"}(u||(u={}));var p=function(t){function n(n){var o=t.call(this)||this;return o._cxt=a.default.cxt,o._inputNode=a.default.cxt.createGain(),o._outputNode=a.default.cxt.createGain(),o._gainNode=a.default.cxt.createGain(),o._volume=e.defaultOptions.volume,o._pitch=e.defaultOptions.pitch,o.children=[],o.actionFuncs={play:o.playFunc,stop:o.stopFunc,restart:o.restartFunc,pause:o.pauseFunc},o.playFunc=function(){},o.stopFunc=function(){},o.pauseFunc=function(){},o.restartFunc=function(){},n||(n=e.defaultOptions),o.volume=n.volume||e.defaultOptions.volume,o.pitch=n.pitch||e.defaultOptions.pitch,o._delaying=n.useDelay||e.defaultOptions.useDelay,o._panner=new c.default(0,0,0),o._delay=new s.default(o._inputNode,n.delay||e.defaultOptions.delay),o._inputNode.connect(o._panner.node),o._panner.connect(o._gainNode),o._gainNode.connect(o._outputNode),n.useDelay&&o.useDelay(),o}return i(n,t),n.prototype.useDelay=function(){this._delaying=!0,this._delay.connect(this._gainNode)},n.prototype.unuseDelay=function(){this._delaying=!1,this._delay.disconnect()},Object.defineProperty(n.prototype,"delay",{get:function(){return this._delay},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"delaying",{get:function(){return this._delaying},enumerable:!1,configurable:!0}),n.prototype.addChildren=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0,o=t.length;n<o;n++)this.addChild(t[n])},n.prototype.addChild=function(t){this.children.push(t),t.connect(this._inputNode),t.parent=this},n.prototype.connect=function(t){this._outputNode.connect(t)},n.prototype._makeAllChildrenDo=function(t){for(var e=this.children,n=0,o=e.length;n<o;n++)e[n].actionFuncs[t]()},n.prototype.play=function(){this.playFunc(),this._makeAllChildrenDo(u.play)},n.prototype.stop=function(){this.stopFunc(),this._makeAllChildrenDo(u.stop)},n.prototype.pause=function(){this.pauseFunc(),this._makeAllChildrenDo(u.pause)},n.prototype.restart=function(){this.restartFunc(),this._makeAllChildrenDo(u.restart)},Object.defineProperty(n.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this._gainNode.gain.value=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pitch",{get:function(){return this._pitch},set:function(t){this._pitch=t},enumerable:!1,configurable:!0}),n.prototype.calcWorldPitch=function(){return this.parent?this.parent.calcWorldPitch()*this.parent.pitch:1},Object.defineProperty(n.prototype,"panner",{get:function(){return this._panner},enumerable:!1,configurable:!0}),n}((function(){}));e.default=p;var d=function(t){function e(){var e=t.call(this)||this;return e.connect(a.default.cxt.destination),e}return i(e,t),e}(p);e.MasterContainer=d},890:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.defaultDelayParams=void 0;var i=o(n(557)),r={interval:1,attenuation:.5};e.defaultDelayParams=r;var u=function(){function t(t,e){this._interval=r.interval,this._attenuation=r.attenuation,this._delayNode=i.default.cxt.createDelay(10),this._attenuationNode=i.default.cxt.createGain(),this._delaySwitch=i.default.cxt.createGain(),e?(e.interval=e.interval||r.interval,e.attenuation=e.attenuation||r.attenuation):e=r,this.interval=e.interval,this.attenuation=e.attenuation,t.connect(this._delayNode),this._delayNode.connect(this._attenuationNode),this._attenuationNode.connect(this._delayNode),this._delayNode.connect(this._delaySwitch)}return Object.defineProperty(t.prototype,"interval",{get:function(){return this._interval},set:function(t){t=Math.min(Math.max(t,0),10),this._interval=t,this._delayNode.delayTime.value=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"attenuation",{get:function(){return this._attenuation},set:function(t){this._attenuation=t,this._attenuationNode.gain.value=t},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){this.interval=t,this.attenuation=e},t.prototype.connect=function(t){this._delaySwitch.connect(t)},t.prototype.disconnect=function(){this._delaySwitch.disconnect(0)},t}();e.default=u},666:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(557)),r={x:0,y:0,z:0},u=function(){function t(t,e,n){this._pannerNode=i.default.cxt.createPanner(),this._position=r,t&&(this.x=t),e&&(this.y=e),n&&(this.z=n)}return Object.defineProperty(t.prototype,"x",{get:function(){return this._position.x},set:function(t){this._position.x=t,this._pannerNode.positionX.value=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._position.y},set:function(t){this._pannerNode.positionY.value=t,this._position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._position.z},set:function(t){this._pannerNode.positionZ.value=t,this._position.z=t},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e,n){return this.x=t,this.y=e,this.z=n,this},Object.defineProperty(t.prototype,"node",{get:function(){return this._pannerNode},enumerable:!1,configurable:!0}),t.prototype.connect=function(t){this._pannerNode.connect(t)},t}();e.default=u},75:function(t,e,n){var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var u=n(285),a=Object.assign(u.defaultOptions,{loop:!1}),s=function(t){function e(e,n){var o=t.call(this,n)||this;return o._duration=0,o._playedTime=0,o._startedTime=0,o._loop=!1,o._playing=!1,o.reStartFunc=function(){o._play(o._playedTime)},o.playFunc=function(){o._playedTime=0,o._play(0)},o.stopFunc=function(){o._playing&&o._sourceNode&&(o._sourceNode.stop(0),o._sourceNode.disconnect(0),o._endThen())},o.pauseFunc=function(){o._playing&&(o._playedTime=(o._playedTime+o._cxt.currentTime-o._startedTime)%o._duration,o._playing=!1,o._sourceNode.stop(0))},o._buffer=e,o._duration=e.duration,n||(n=a),o.loop=n.loop||a.loop,o.actionFuncs={play:o.playFunc,restart:o.restartFunc,stop:o.stopFunc,pause:o.pauseFunc},o}return i(e,t),Object.defineProperty(e.prototype,"buffer",{set:function(t){this._buffer=t,this._duration=t.duration},enumerable:!1,configurable:!0}),e.prototype._play=function(t){if(void 0===t&&(t=0),this._buffer){var e=this._cxt;this._sourceNode=e.createBufferSource(),this._sourceNode.buffer=this._buffer,this._sourceNode.loop=this._loop;var n=this.calcWorldPitch()*this._pitch;this._sourceNode.playbackRate.value=n;var o=this._sourceNode;if(o.connect(this._inputNode),o.start(0,t),this._sourceNode=o,this._startedTime=e.currentTime,this._playing=!0,!this.loop){var i=1e3*this._duration/n;setTimeout(this._disconnectSourceNode.bind(this),i,o),this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=void 0),this._endTimer=setTimeout(this._endThen.bind(this),i)}}},e.prototype._disconnectSourceNode=function(t){t.disconnect(0)},e.prototype._endThen=function(){this._playing=!1,this._playedTime=0,this._endTimer=void 0},Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this._sourceNode&&(this._sourceNode.loop=t)},enumerable:!1,configurable:!0}),e}(r(n(285)).default);e.default=s},607:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Container=e.App=e.SoundMaster=e.Sound=void 0;var i=o(n(75));e.Sound=i.default;var r=o(n(557));e.SoundMaster=r.default;var u=o(n(178));e.App=u.default;var a=o(n(285));e.Container=a.default},108:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(557)),r=function(){function t(){this._resources=new Map,this._datas=new Map,this._tasks=[],this._loadThen=function(){},this._cxt=i.default.cxt}return t.prototype.add=function(t,e){var n=this._promiseLoadingSound(t,e);return this._tasks.push(n),this},t.prototype.loadAll=function(){var t=this;Promise.all(this._tasks).then((function(){t._loadThen()}))},t.prototype.loadThen=function(t){this._loadThen=t},t.prototype._promiseLoadingSound=function(t,e){var n=this;return new Promise((function(o){fetch(e).then((function(t){return t.arrayBuffer()})).then((function(e){return n._datas.set(t,e),n._cxt.decodeAudioData(e)})).then((function(e){n._resources.set(t,e),o(e)}))}))},t.prototype.getResource=function(t){return this._resources.get(t)},t.prototype.getData=function(t){return this._datas.get(t)},t}();e.default=r}},e={};return function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={exports:{}};return t[o].call(r.exports,r,r.exports,n),r.exports}(607)})()}));