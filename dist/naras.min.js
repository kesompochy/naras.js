!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("NARAS",[],e):"object"==typeof exports?exports.NARAS=e():t.NARAS=e()}(self,(function(){return(()=>{"use strict";var t={178:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(108)),r=o(n(557)),a=n(894),u=function(){function t(){this.loader=i.default,this.baseMixer=new a.MasterMixer,this._unlockEvents=["click","scroll","touchstart"];for(var t=0,e=this._unlockEvents.length;t<e;t++)document.addEventListener(this._unlockEvents[t],this._initContext.bind(this),{once:!0});this._initContext()}return t.prototype._initContext=function(){"suspended"===r.default.cxt.state&&r.default.cxt.resume();for(var t=0,e=this._unlockEvents.length;t<e;t++)document.removeEventListener(this._unlockEvents[t],this._initContext.bind(this))},t.prototype.addResource=function(t,e){return this.loader.add(t,e),this},t.prototype.loadAll=function(){this.loader.loadAll()},t.prototype.loadThen=function(t){this.loader.loadThen(t)},Object.defineProperty(t.prototype,"loaded",{get:function(){return this.loader.loaded},enumerable:!1,configurable:!0}),t}();e.default=u},557:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=window.AudioContext||window.webkitAudioContext,o=function(){function t(){}return t.cxt=new n,t}();e.default=o},385:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){this.buffer=t,this.duration=t.duration}},607:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Loader=e.Processer=e.Sound=e.Mixer=e.App=void 0;var i=o(n(501));e.Sound=i.default;var r=o(n(178));e.App=r.default;var a=o(n(894));e.Mixer=a.default;var u=o(n(412));e.Processer=u.default;var s=o(n(108));e.Loader=s.default},108:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(557)),r=o(n(385)),a=function(){function t(){}return t.add=function(t,e){var n=this._promiseLoadingSound(t,e);return this._tasks.push(n),this.loaded=!1,this},t.loadAll=function(){var t=this;this._taskNum=this._tasks.length,this._progressManager(this._taskNum,this._taskNum),Promise.all(this._tasks).then((function(){t.loaded=!0,t._loadThen()}))},t.loadThen=function(t){this._loadThen=t,0===this._tasks.length&&t()},t._promiseLoadingSound=function(t,e){var n=this;return new Promise((function(o){fetch(e).then((function(t){return t.arrayBuffer()})).then((function(t){return n._cxt.decodeAudioData(t)})).then((function(e){var i=new r.default(e);n._resources.set(t,i),n._tasks.shift(),n._progressManager(n._taskNum,n._tasks.length),o(e)}))}))},t.manageProgress=function(t){this._progressManager=t},t.get=function(t){return this._resources.get(t)},t._resources=new Map,t._tasks=[],t._loadThen=function(){},t._cxt=i.default.cxt,t._progressManager=function(){},t._taskNum=0,t.loaded=!1,t}();e.default=a},341:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.defaultDelayParams=void 0;var i=o(n(557)),r={interval:1e3,attenuation:.5};e.defaultDelayParams=r;var a=function(){function t(t,e){this._interval=r.interval,this._attenuation=r.attenuation,this._delayNode=i.default.cxt.createDelay(10),this._attenuationNode=i.default.cxt.createGain(),this._delaySwitch=i.default.cxt.createGain(),this._realScale=1,e?(e.interval=e.interval||r.interval,e.attenuation=e.attenuation||r.attenuation):e=r,this.interval=e.interval,this.attenuation=e.attenuation,t.connect(this._delayNode),this._delayNode.connect(this._attenuationNode),this._attenuationNode.connect(this._delayNode),this._delayNode.connect(this._delaySwitch)}return Object.defineProperty(t.prototype,"interval",{get:function(){return this._interval},set:function(t){t=Math.min(Math.max(t,0),1e4),this._interval=t,this._delayNode.delayTime.value=t/1e3*this._realScale},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"attenuation",{get:function(){return this._attenuation},set:function(t){this._attenuation=t,this._attenuationNode.gain.value=t},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){this.interval=t,this.attenuation=e},Object.defineProperty(t.prototype,"realScale",{set:function(t){this._realScale=t,this._delayNode.delayTime.value=this._interval/1e3*t},enumerable:!1,configurable:!0}),t.prototype.connect=function(t){this._delaySwitch.connect(t)},t.prototype.disconnect=function(){this._delaySwitch.disconnect(0)},t}();e.default=a},844:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(557)),r={x:0,y:0,z:0},a=function(){function t(t,e,n){this._pannerNode=i.default.cxt.createPanner(),this._position=r,t&&(this.x=t),e&&(this.y=e),n&&(this.z=n)}return Object.defineProperty(t.prototype,"x",{get:function(){return this._position.x},set:function(t){this._position.x=t,this._pannerNode.positionX.value=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._position.y},set:function(t){this._pannerNode.positionY.value=t,this._position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._position.z},set:function(t){this._pannerNode.positionZ.value=t,this._position.z=t},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e,n){return this.x=t,this.y=e,this.z=n,this},Object.defineProperty(t.prototype,"node",{get:function(){return this._pannerNode},enumerable:!1,configurable:!0}),t.prototype.connect=function(t){this._pannerNode.connect(t)},t}();e.default=a},894:function(t,e,n){var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.MasterMixer=e.defaultOptions=void 0;var a=r(n(557)),u=r(n(341)),s=r(n(844)),l=n(341);e.defaultOptions={volume:1,loop:!1,scale:1,delay:l.defaultDelayParams,useDelay:!1,panner:{x:0,y:0,z:0}};var c=function(){function t(t){this._cxt=a.default.cxt,this._inputNode=a.default.cxt.createGain(),this._gainNode=a.default.cxt.createGain(),this._volume=e.defaultOptions.volume,this._scale=e.defaultOptions.scale,this._duration=0,this._playedTime=0,this._startedTime=0,this._position=0,this.children=[],this.isSound=!1,this._playPosition=0,this._playScale=1,this.playAction=function(){},this.stopAction=function(){},this.pauseAction=function(){},this.restartAction=function(){},t||(t=e.defaultOptions);var n=t.panner||e.defaultOptions.panner;this._panner=new s.default(n.x,n.y,n.z),this._delay=new u.default(this._inputNode,t.delay||e.defaultOptions.delay),this.volume=t.volume||e.defaultOptions.volume,this.scale=t.scale||e.defaultOptions.scale,this._useDelay=t.useDelay||e.defaultOptions.useDelay,this.useDelay=this._useDelay,this._inputNode.connect(this._panner.node),this._panner.connect(this._gainNode)}return Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useDelay",{get:function(){return this._useDelay},set:function(t){this._useDelay=t,t?this._delay.connect(this._gainNode):this._delay.disconnect()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"delay",{get:function(){return this._delay},enumerable:!1,configurable:!0}),t.prototype.addChildren=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0,o=t.length;n<o;n++)this.addChild(t[n])},t.prototype.addChild=function(t){this.children.push(t),t.connect(this._inputNode),t.parent=this},t.prototype.connect=function(t){this._gainNode.connect(t)},Object.defineProperty(t.prototype,"playScale",{get:function(){return this._playScale},set:function(t){this._playScale=t,this._delay.realScale=t},enumerable:!1,configurable:!0}),t.prototype.play=function(){this._propagateOrder("play")},t.prototype.stop=function(){this._propagateOrder("stop")},t.prototype.pause=function(){this._propagateOrder("pause")},t.prototype.restart=function(){this._propagateOrder("restart")},t.prototype._propagateOrder=function(t,e){var n=this;this._playPosition=this._calcPlayPosition(e),this.playScale=this._calcPlayScale(e),this.children.forEach((function(e){e._propagateOrder(t,n)})),this[t+"Action"]()},t.prototype._calcPlayPosition=function(t){return t?t._playPosition+this._position*t._playScale:0},t.prototype._calcPlayScale=function(t){return t?t._playScale*this._scale:this._scale},Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this._gainNode.gain.value=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this._scale},set:function(t){this._scale=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"panner",{get:function(){return this._panner},enumerable:!1,configurable:!0}),t}();e.default=c;var f=function(t){function e(){var e=t.call(this)||this;return e.connect(a.default.cxt.destination),e}return i(e,t),e}(c);e.MasterMixer=f},412:function(t,e,n){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(n(557)),r=o(n(385)),a=function(){function t(){}return t._forAllChannels=function(t,e,n){for(var o=0,i=t.numberOfChannels;o<i;o++)n(e.getChannelData(o),t.getChannelData(o));return e},t._createSameSizedBuffer=function(t){return i.default.cxt.createBuffer(t.numberOfChannels,t.length,t.sampleRate)},t.reverse=function(e){var n=e.buffer,o=t._createSameSizedBuffer(n);return new r.default(t._forAllChannels(n,o,(function(t,e){for(var o=0,i=n.length;o<i;o++)t[o]=e[i-o]})))},t.trim=function(e,n,o){var a=e.buffer,u=a.sampleRate,s=(o-n)*a.sampleRate,l=i.default.cxt.createBuffer(a.numberOfChannels,s,u);return new r.default(t._forAllChannels(a,l,(function(t,e){for(var o=0,i=s;o<i;o++)t[o]=e[n*u+o]})))},t.raisePitch=function(e,n,o){var a=e.buffer,u=i.default.cxt.createBuffer(a.numberOfChannels,a.length,a.sampleRate);return new r.default(t._forAllChannels(a,u,(function(t,e){for(var i=0,r=a.length/n;i<r;i++)for(var u=0,s=n;u<s;u++)t[i*n+u]=e[Math.min(i*n+(u*o|0)%n,a.length-1)]})))},t.lowerPitch=function(e,n,o){var i=e.buffer,a=t._createSameSizedBuffer(i);return new r.default(t._forAllChannels(i,a,(function(t,e){for(var r=0,a=i.length/n;r<a;r++)for(var u=0,s=n*o;u<s;u++)t[r*n+u]=e[Math.min(r*n+(u/o|0),i.length-1)]})))},t.noise=function(e,n,o,i){var a=e.buffer,u=t._createSameSizedBuffer(a);return new r.default(t._forAllChannels(a,u,(function(t,e){for(var r=0,u=a.length;r<u;r++)Math.random()>n?t[r]=e[r]+2*(Math.random()-.5)*i:t[r]=2*o*(Math.random()-.5)})))},t.blur=function(e,n){var o=e.buffer,i=t._createSameSizedBuffer(o);return new r.default(t._forAllChannels(o,i,(function(t,e){for(var i=0,r=o.length;i<r;i++){for(var a=0,u=2*n+1,s=0,l=u;s<l;s++)a+=e[Math.max(Math.min(i-n+s,o.length-1),0)];t[i]=a/u}})))},t}();e.default=a},501:function(t,e,n){var o,i=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(894),u=1e3,s=Object.assign(a.defaultOptions,{loop:!1}),l=function(t){function e(e,n){var o=t.call(this,n)||this;return o._duration=0,o._loop=!1,o._playing=!1,o.isSound=!0,o.restartAction=function(){o._play(o._playedTime)},o.playAction=function(){o._playedTime=0,o._play(0)},o.stopAction=function(){o._playing&&o._sourceNode&&(o._sourceNode.stop(0),o._sourceNode.disconnect(0),o._endThen())},o.pauseAction=function(){o._playing&&(o._playedTime=(o._playedTime+o._cxt.currentTime-o._startedTime)%(o._duration/u),o._playing=!1,o._sourceNode.stop(0))},o._audio=e,e&&(o._duration=e.duration*u),n||(n=s),o.loop=n.loop||s.loop,o}return i(e,t),Object.defineProperty(e.prototype,"audio",{set:function(t){this._audio=t,this._duration=t.duration},enumerable:!1,configurable:!0}),e.prototype._play=function(t){if(void 0===t&&(t=0),this._audio){var e=this._cxt;this._sourceNode=e.createBufferSource(),this._sourceNode.buffer=this._audio.buffer,this._sourceNode.loop=this._loop;var n=this._playScale,o=this._playPosition;this._sourceNode.playbackRate.value=1/n;var i=this._sourceNode;i.connect(this._inputNode);var r=e.currentTime+o/u;if(i.start(r,t),this._sourceNode=i,this._startedTime=r,this._playing=!0,!this.loop){var a=o+this._duration*n;setTimeout(this._disconnectSourceNode.bind(this),a,i),this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=void 0),this._endTimer=setTimeout(this._endThen.bind(this),a)}}},e.prototype._disconnectSourceNode=function(t){t.disconnect(0)},e.prototype._endThen=function(){this._playing=!1,this._playedTime=0,this._sourceNode=null,this._endTimer=void 0},Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this._sourceNode&&(this._sourceNode.loop=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),e}(r(n(894)).default);e.default=l}},e={};return function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={exports:{}};return t[o].call(r.exports,r,r.exports,n),r.exports}(607)})()}));