{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://NARAS/webpack/universalModuleDefinition","webpack://NARAS/./src/index.ts","webpack://NARAS/./src/loader.ts","webpack://NARAS/./src/master.ts","webpack://NARAS/./src/sound.ts","webpack://NARAS/webpack/bootstrap","webpack://NARAS/webpack/before-startup","webpack://NARAS/webpack/startup","webpack://NARAS/webpack/after-startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"NARAS\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"NARAS\"] = factory();\n\telse\n\t\troot[\"NARAS\"] = factory();\n})(self, function() {\nreturn ","\r\nimport Sound from './sound';\r\nimport SoundMaster from './master';\r\n\r\nexport {Sound, SoundMaster};","export default class Loader{\r\n    resources: Map<string, any> = new Map();\r\n    tasks: Array<Promise<unknown>> = [];\r\n    private _loadThen: Function = function(){}\r\n    add(id: string, src: string): Loader{\r\n        const promise = this._promiseLoadingSound(id, src);\r\n        this.tasks.push(promise);\r\n        return this;\r\n    }\r\n    loadAll(): void{\r\n        Promise.all(this.tasks)\r\n            .then(()=>{this._loadThen();});\r\n    }\r\n    loadThen(func: Function){\r\n        this._loadThen = func;\r\n    }\r\n    private _promiseLoadingSound(id: string, src: string): Promise<any>{\r\n        const promise = new Promise((resolve)=>{\r\n            fetch(src).then((res)=>{\r\n                const data = res.arrayBuffer();\r\n                this.resources.set(id, data);\r\n                resolve(data); \r\n            })\r\n        });\r\n\r\n        return promise;\r\n    }\r\n    get(id: string){\r\n        return this.resources.get(id);\r\n    }\r\n}","import Loader from './loader';\r\n\r\ndeclare global {\r\n    interface Window {\r\n        webkitAudioContext: any\r\n    }\r\n}\r\n\r\nconst AudioContext = window.AudioContext || window.webkitAudioContext;\r\n\r\nexport default class SoundMaster{\r\n    cxt: AudioContext = new AudioContext();\r\n    private _masterGain: GainNode = this.cxt.createGain();\r\n    private _unlockEvents: string[] = ['click', 'scroll', 'touchstart'];\r\n\r\n    loader: Loader = new Loader();\r\n    constructor(){\r\n        this._masterGain.connect(this.cxt.destination);\r\n\r\n        //for(let i=0, len=this._unlockEvents.length;i<len;i++){\r\n        //    document.addEventListener(this._unlockEvents[i], this._initContext.bind(this), {once: true});\r\n        //}\r\n        this.initContext();\r\n    }\r\n    initContext(): void{\r\n        if(this.cxt.state === 'suspended'){\r\n            this.cxt.resume();\r\n        }\r\n        for(let i=0, len=this._unlockEvents.length;i<len;i++){\r\n            document.removeEventListener(this._unlockEvents[i], this.initContext.bind(this));\r\n        }\r\n    }\r\n}","import SoundContext from './master';\r\n\r\nexport default class Sound {\r\n    _buffer: any;\r\n    _gainNode: GainNode;\r\n    acxt: SoundContext;\r\n    _duration: number = 0;\r\n    playing: boolean = false;\r\n    _volume: number = 1;\r\n    _loop: boolean = false;\r\n    _bufferSource: AudioBufferSourceNode;\r\n    _endTimer: any | undefined;\r\n    _startTime: number = 0;\r\n    playedTime: number = 0;\r\n    constructor(acxt: SoundContext){\r\n        this.acxt = acxt;\r\n        const cxt = acxt.cxt;\r\n\r\n        this._bufferSource = cxt.createBufferSource();\r\n\r\n        this._gainNode = cxt.createGain();\r\n        this._gainNode.connect(cxt.destination);\r\n    }\r\n    play(){\r\n        const cxt = this.acxt.cxt;\r\n        \r\n        const sourceBuffer = cxt.createBufferSource();\r\n        sourceBuffer.buffer = this._buffer;\r\n        sourceBuffer.loop = this._loop;\r\n        sourceBuffer.connect(this._gainNode);\r\n        sourceBuffer.start(0, this.playedTime);\r\n\r\n        this._bufferSource = sourceBuffer;\r\n\r\n        this._startTime = cxt.currentTime;\r\n\r\n        this.playing = true;\r\n        if(!this._loop) this._endTimer = setTimeout(this.endThen.bind(this), this._duration*1000);\r\n    }\r\n    pause(){\r\n        if(this.playing) {\r\n            this.playedTime = (this.playedTime + this.acxt.cxt.currentTime - this._startTime) % this._duration;\r\n            this.playing = false;\r\n            this._bufferSource.stop(0);\r\n            this._clearTimer();\r\n        }\r\n    }\r\n    _clearTimer(){\r\n        clearTimeout(this._endTimer);\r\n    }\r\n    stop(){\r\n        if(this.playing) this._bufferSource.stop(0);\r\n        this.endThen();\r\n    }\r\n    endThen(){\r\n        this.playing = false;\r\n        this._bufferSource.disconnect(0);\r\n    }\r\n    set buffer(buf){\r\n        this._buffer = buf;\r\n        this._duration = buf.duration;\r\n    }\r\n    set volume(vol: number){\r\n        this._volume = vol;\r\n        this._gainNode.gain.value = vol;\r\n    }\r\n\r\n    set loop(bool: boolean){\r\n        this._loop = bool;\r\n    }\r\n    get loop(){\r\n        return this._loop;\r\n    }\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/index.ts\");\n",""],"names":[],"sourceRoot":""}